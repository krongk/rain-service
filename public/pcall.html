<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Language" content="zh-CN" />
    <meta name="robots" content="INDEX,FOLLOW" />
    <meta name="author" content="master@inruby.com" />
    <!-- this enables responsive features in browser -->
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>

    <title>来电通</title>
    <meta name="description" content="pcall">
  </head>
  <body>
    <h1>来电通测试</h1>

  <form accept-charset="UTF-8" action="http://www.65960.com/pcall" id="pcall_form" method="post">
    <input class="hidden" id="phone_call_domain" name="phone_call[domain]" type="hidden" value="www.abc.com" />
    <input class="hidden" id="phone_call_user_id" name="phone_call[user_id]" type="hidden" value="29" />
    
    <div class="control-group tel optional phone_call_from_phone">
      <label class="tel optional control-label" for="phone_call_from_phone">请输入您的手机号</label>
      <div class="controls">
        <input class="string tel optional" id="phone_call_from_phone" name="phone_call[from_phone]" type="tel" />
        <input class="btn btn-primary btn-large" id="phone_call_commit" name="commit" type="submit" value="提交" />
      </div>
    </div>
  </form>

<!-- ######################################## -->
<script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
<script src="http://www.65960.com/common_js/jquery.json-2.4.min.js"></script>

<script type="text/javascript">
  (function() {
    $(function() {
      $("#pcall_form").submit(function() {
        //var vdata = $(this).serialize(); //序列化表单数据
        var vdata = $.toJSON($(this).serialize());
        //检查手机号码正确性
        var num1 = document.getElementById("phone_call_from_phone").value;
        if (num1 !== "" && !num1.match(/^1[3|4|5|8][0-9]\d{4,8}$/))
        {
          alert('请输入正确的手机号码');
          return false;
        }
        //提交数据
        $.ajax({
          type: "POST",
          dataType: "json",
          crossDomain: true,
          contentType: 'application/json; charset=utf-8',
          url: "http://www.65960.com/pcall?callback=?",
          data: vdata,
          success: function(data) {
            alert(data.id);
            return false;
          },
          error: function(data) {
            alert("error")
            return false;
          }
        });
        alert("信息提交成功！");
        $("#phone_call_from_phone").val('');
        return false;
      });
    });

  }).call(this);
</script>
</body>
</html>

